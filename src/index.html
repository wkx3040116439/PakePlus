<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>用户信息生成器</title>
  <script src="regionData.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/element-plus/dist/index.css" rel="stylesheet">
  <style>
    body { padding: 20px; font-family: 'Microsoft YaHei', sans-serif; background: #f5f7fa; }
    .container { max-width: 1200px; margin: 0 auto; }
    .table-wrapper { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); }
    .toolbar { margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; }
    select, button { padding: 8px; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    th:nth-child(1), td:nth-child(1) { width: 90px; }
    th:nth-child(2), td:nth-child(2) { width: 60px; text-align: center; }
  </style>
</head>
<body>
<div class="container">
  <div class="toolbar">
    <select id="provinceSelect"></select>
    <select id="citySelect"></select>
    <button onclick="generateData()">生成数据</button>
    <button onclick="clearData()">清除数据</button>
  </div>
  <div class="table-wrapper">
    <table id="userTable">
      <thead>
        <tr>
          <th>姓名</th><th>性别</th><th>身份证号</th><th>手机号</th><th>邮箱</th><th>地址</th><th>银行卡号</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
const surnames = ["赵", "钱", "孙", "李", "周", "吴", "郑", "王", "冯", "陈", "褚", "卫", "蒋", "沈", "韩", "杨", "朱", "秦", "尤", "许", "何", "吕", "施", "张", "孔", "曹", "严", "华", "金", "魏"];
const nameChars = "伟刚勇毅俊峰强军平保东文辉力明永健世广志义兴良海山仁波宁贵福生龙元全国胜学祥才发武新利清飞彬富顺信子杰涛昌成康星光天达安岩中茂进林有坚和彪博诚先敬震振壮会思群豪心邦承乐绍功松善厚庆磊民友裕河哲江超浩亮政谦亨奇固之轮翰朗伯宏言若鸣朋斌梁栋维启克伦翔旭鹏泽晨辰士以建家致树炎德行时泰盛雄琛钧冠策腾楠榕风航弘";

function getRandomFromArray(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}
function randomKey(obj) {
  const keys = Object.keys(obj);
  return keys[Math.floor(Math.random() * keys.length)];
}
function randomItem(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}
function generateName() {
  const surname = getRandomFromArray(surnames);
  const len = Math.random() < 0.5 ? 1 : 2;
  let name = "";
  for (let i = 0; i < len; i++) {
    name += nameChars.charAt(Math.floor(Math.random() * nameChars.length));
  }
  return surname + name;
}
// 简单汉字转拼音首字母（仅示例，实际可用第三方库如pinyin.js）
function toPinyin(name) {
  const map = {
    "赵":"zhao","钱":"qian","孙":"sun","李":"li","周":"zhou","吴":"wu","郑":"zheng","王":"wang","冯":"feng","陈":"chen","褚":"chu","卫":"wei","蒋":"jiang","沈":"shen","韩":"han","杨":"yang","朱":"zhu","秦":"qin","尤":"you","许":"xu","何":"he","吕":"lv","施":"shi","张":"zhang","孔":"kong","曹":"cao","严":"yan","华":"hua","金":"jin","魏":"wei"
  };
  let py = "";
  if (map[name[0]]) py += map[name[0]];
  else py += "user";
  for (let i = 1; i < name.length; i++) py += "x";
  return py;
}
function generateEmail(name) {
  const domains = ["@qq.com", "@163.com", "@gmail.com", "@outlook.com", "@sina.com", "@hotmail.com", "@yahoo.com"];
  const domain = domains[Math.floor(Math.random() * domains.length)];
  return toPinyin(name) + domain;
}
function generatePhone() {
  const prefix = ["130", "131", "132", "133", "134", "135", "136", "137", "138", "139"];
  return prefix[Math.floor(Math.random() * prefix.length)] + Math.floor(Math.random() * 1e8).toString().padStart(8, '0');
}
function randomDate() {
  const start = new Date(1970, 0, 1);
  const end = new Date(2005, 0, 1);
  const date = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
  const y = date.getFullYear(), m = String(date.getMonth() + 1).padStart(2, '0'), d = String(date.getDate()).padStart(2, '0');
  return `${y}${m}${d}`;
}
function calculateCheckCode(id17) {
  const weights = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2];
  const checkMap = ['1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'];
  let sum = 0;
  for (let i = 0; i < 17; i++) {
    sum += parseInt(id17[i], 10) * weights[i];
  }
  return checkMap[sum % 11];
}
function generateIdCard(regionCode) {
  regionCode = regionCode.toString().padStart(6, '0').slice(0, 6);
  const birthday = randomDate();
  const seq = Math.floor(100 + Math.random() * 900);
  const id17 = `${regionCode}${birthday}${seq}`;
  const checkCode = calculateCheckCode(id17);
  return id17 + checkCode;
}
function generateBankCard() {
  return "6222" + Math.floor(Math.random() * 1e15).toString().padStart(15, '0');
}
function generateData() {
  const users = [];
  let count = 0;
  while (count < 50) {
    const prov = randomKey(regionData);
    const provinceObj = regionData[prov];
    if (!provinceObj.children || provinceObj.children.length === 0) continue;
    const cityObj = randomItem(provinceObj.children);
    if (!cityObj.children || cityObj.children.length === 0) continue;
    const districtObj = randomItem(cityObj.children);
    if (!districtObj.children || districtObj.children.length === 0) continue;
    const streetObj = randomItem(districtObj.children);
    let villageObj = null;
    if (streetObj.children && streetObj.children.length > 0) {
      villageObj = randomItem(streetObj.children);
    }
    const address = prov + cityObj.name + districtObj.name + streetObj.name + (villageObj ? villageObj.name : "");
    let regionCode = "610000";
    if (villageObj && villageObj.code) {
      regionCode = villageObj.code;
    } else if (streetObj.code) {
      regionCode = streetObj.code;
    } else if (districtObj.code) {
      regionCode = districtObj.code;
    }
    const name = generateName();
    const gender = Math.random() > 0.5 ? "男" : "女";
    const idCard = generateIdCard(regionCode);
    const phone = generatePhone();
    const bankCard = generateBankCard();
    const email = generateEmail(name);
    users.push({ name, gender, idCard, phone, email, address, province: prov, city: cityObj.name, district: districtObj.name, bankCard });
    count++;
  }
  localStorage.setItem("users", JSON.stringify(users));
  renderTable(users);
}
function clearData() {
  localStorage.removeItem("users");
  renderTable([]);
}
function renderTable(users) {
  const tbody = document.querySelector("#userTable tbody");
  const selectedProvince = document.getElementById("provinceSelect").value;
  const selectedCity = document.getElementById("citySelect").value;
  tbody.innerHTML = "";
  users.filter(u =>
    (!selectedProvince || u.province === selectedProvince) &&
    (!selectedCity || u.city === selectedCity)
  ).forEach(u => {
    tbody.innerHTML += `<tr>
      <td>${u.name}</td>
      <td>${u.gender}</td>
      <td>${u.idCard}</td>
      <td>${u.phone}</td>
      <td>${u.email}</td>
      <td>${u.address}</td>
      <td>${u.bankCard}</td>
    </tr>`;
  });
}
function loadRegions() {
  const provinceSelect = document.getElementById("provinceSelect");
  provinceSelect.innerHTML = '<option value="">全部省份</option>';
  for (const prov in regionData) {
    provinceSelect.innerHTML += `<option value="${prov}">${prov}</option>`;
  }
  loadCities();
  const saved = localStorage.getItem("users");
  if (saved) renderTable(JSON.parse(saved));
}
function loadCities() {
  const provinceSelect = document.getElementById("provinceSelect");
  const citySelect = document.getElementById("citySelect");
  const prov = provinceSelect.value;
  citySelect.innerHTML = '<option value="">全部城市</option>';
  if (prov && regionData[prov]) {
    const cities = regionData[prov].children || [];
    cities.forEach(city => {
      citySelect.innerHTML += `<option value="${city.name}">${city.name}</option>`;
    });
  }
}
window.onload = function() {
  loadRegions();
  document.getElementById("provinceSelect").addEventListener("change", () => {
    loadCities();
    const saved = localStorage.getItem("users");
    if (saved) renderTable(JSON.parse(saved));
  });
  document.getElementById("citySelect").addEventListener("change", () => {
    const saved = localStorage.getItem("users");
    if (saved) renderTable(JSON.parse(saved));
  });
};
</script>
</body>
</html>